# hashdumping and Cracking using john

  * `/etc/passwd` contains account records and is world-readable, but it does **not** contain the actual password hashes.
  * `/etc/shadow` stores the encrypted password hashes and is readable **only by root**. This protects hashes from non-privileged users.
  * The shadow hash format encodes the hashing algorithm identifier in the hash string after `$`. Common identifiers:

    * `$1$` → MD5
    * `$2*` (`$2a$`, `$2y$`, etc.) → Blowfish / bcrypt family
    * `$5$` → SHA-256 crypt
    * `$6$` → SHA-512 crypt
  * The algorithm identifier tells cracking tools which format to use (for example, `$6$` → `sha512crypt`).

* **Commands / prompts you provided**

  1. Metasploit post-exploit module to download unshadowed files (needs privileges):

     ```
     linux/gather/hashdump
     ```

     — This module can harvest `/etc/shadow` (and `/etc/passwd`) from a compromised Linux host if you have a session with sufficient privileges.
  2. John the Ripper command to crack a sha512crypt hash using a wordlist:

     ```
     john --format=sha512crypt --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
     ```

     — `--format=sha512crypt` selects the correct format for `$6$` hashes. `--wordlist` points John to the rockyou wordlist. `hash.txt` is the file containing the extracted hash(es).

* **What each command does (short)**

  * `linux/gather/hashdump`: extracts passwd/shadow information from a target (post-exploit).
  * `john --format=sha512crypt --wordlist=...`: runs an offline dictionary attack against `sha512crypt` hashes using the provided wordlist.

* **Why this matters (security perspective)**

  * If an attacker obtains `/etc/shadow`, they can run offline attacks (no rate limits) against account passwords. Strong hashes + high work factors slow attackers; long/complex passwords and MFA defeat many attacks.
  * Monitoring for unusual reads of `/etc/shadow` or processes that harvest it is important (auditd, SIEM). Prevent initial compromise to avoid post-exploit modules running at all.

