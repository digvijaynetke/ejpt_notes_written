

````markdown
# Windows Local Enumeration

> üõë For **authorized penetration testing** and lab environments only.  
> Objective: Gather OS, user, network, and service information to identify privilege escalation paths, lateral movement opportunities, and persistence mechanisms.

---

## üéØ Why Local Enumeration?
After initial access (reverse/bind shell, Meterpreter, RDP, etc.), you need to:
- Identify OS build, service pack, hotfixes ‚Üí check for known vulns.
- Enumerate users, groups, privileges ‚Üí spot escalation vectors.
- Gather network info ‚Üí useful for pivoting.
- List processes/services ‚Üí find stable processes for migration, sensitive services, scheduled tasks.
- Automate enumeration for efficiency.

---

## üñ•Ô∏è System Information
Identify OS details, architecture, updates, and patches.

**Meterpreter**
```text
getuid          # current user
sysinfo         # system info
shell           # drop into cmd shell
````

**CMD Shell**

```text
hostname
systeminfo      # OS, processor, build, boot device, timezone, RAM, logon server, hotfixes
wmic qfe get Caption,Description,HotFixID,InstalledOn
```

üîé **Explanation**:
`wmic qfe get ...` lists all installed patches (KB numbers) ‚Üí you can research each to find missing patches or unpatched vulnerabilities.
>wmic qfe get Caption,Description,HotFixID,InstalledOn

**Other tricks**

```text
cd C:\Windows\System32
type eula.txt   # sometimes leaks OS build/version
```

---

## üë• Enumerating Users & Groups

Why? To find **low-priv users**, identify **admin group members**, and plan escalation.

**Meterpreter**

```text
getuid
getprivs
search logged_on
```

**CMD / Powershell**

```text
whoami
whoami /priv              # privileges of current user
query user                # list logged-in users
net users                 # list all users
net user administrator    # detailed info about one user
net localgroup            # list groups
net localgroup administrators   # members of local admin group
```

### Difference: Local Administrator vs. NT AUTHORITY\SYSTEM

* **Local Administrator group** = local admin privileges (like root).
* **NT AUTHORITY\SYSTEM** = highest Windows privilege, kernel/system-level.
  (SYSTEM is above Administrator in power; often the privesc target).

---

## üåê Enumerating Network Information

Why? To understand the host‚Äôs position in the network, useful for pivoting.

```text
ipconfig              # IP, subnet, default gateway
ipconfig /all         # DNS suffix, DHCP, MAC, DNS server, lease info
route print           # routing table (shows active networks/subnets)
arp -a                # ARP table (other hosts in LAN)
netstat -ano          # TCP/UDP connections with PIDs
```

### Firewall Enumeration

```text
netsh firewall show state
netsh advfirewall firewall state
netsh advfirewall firewall show
netsh advfirewall firewall dump
netsh advfirewall show allprofiles
```

These commands show current firewall rules, enabled profiles, and filtering state.

---

## ‚öôÔ∏è Enumerating Processes & Services

Why?

* To migrate into a **stable process** (e.g., explorer.exe).
* To spot **interesting services** (misconfigs, escalations).
* To discover **scheduled tasks** (potential SYSTEM execution).

**Meterpreter**

```text
ps                       # list processes
pgrep explorer.exe       # find PID of explorer.exe
migrate <PID>            # migrate into stable process
getuid                   # check privileges
kill <PID>               # kill unstable process
```

**CMD / PowerShell**

```text
net start                # running services
wmic service list brief  # services: ExitCode, Name, PID, State
tasklist /SVC            # process + service mapping
>it will show the process runing aswell as perticular service runing under the process
>eg lsass.exe    ser= KeyIso, SamSs


schtasks /query /fo LIST          # list scheduled tasks
schtasks /query /fo LIST /v       # verbose scheduled tasks
```

üëâ Look for **SYSTEM-owned scheduled tasks** for privilege escalation.

---

## ü§ñ Automating Enumeration

Manual checks take time ‚Äî use scripts to save effort.

### JAWS (Just Another Windows Enumeration Script)

* PowerShell script to enumerate Windows targets for privilege escalation vectors.

Steps:

```powershell
# Attacker: copy script over (e.g., jaws-enum.ps1)
powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt
```

Output will be in `JAWS-Enum.txt` with detailed enumeration.

---

## üõ†Ô∏è Extra Meterpreter Post Modules

* `post/windows/gather/enum_logged_on_users` ‚Üí list logged users
* `post/windows/gather/checkvm` ‚Üí check if host is a VM
* `post/windows/gather/enum_applications` ‚Üí installed apps
* `post/windows/gather/enum_computers` ‚Üí AD/domain computers
* `post/windows/gather/enum_patches` ‚Üí installed hotfixes/patches
* `post/windows/gather/enum_shares` ‚Üí shared folders
* `post/windows/manage/privs` ‚Üí detailed privilege checks

---

## ‚úÖ Practical Takeaways

* Start with `systeminfo` & `wmic qfe` to find OS & hotfix info.
* Enumerate **users & groups** (`net user`, `net localgroup administrators`) for escalation paths.
* Use `ipconfig`, `route print`, `arp -a`, `netstat` for **network discovery** (important for pivoting).
* Review **processes & services** to decide **process migration** and locate sensitive services.
* Always automate with scripts like **JAWS** + Metasploit modules for efficiency.

---

## üìå Example Lab Flow (Quick Recap)

1. Exploit target (e.g., Rejetto HFS) ‚Üí Meterpreter.
2. Run:

   ```text
   getuid
   sysinfo
   shell ‚Üí systeminfo
   ```
3. Enumerate users:

   ```text
   net users
   net localgroup administrators
   ```
4. Enumerate network:

   ```text
   ipconfig /all
   route print
   arp -a
   ```
5. Enumerate services & tasks:

   ```text
   wmic service list brief
   schtasks /query /fo LIST /v
   ```
6. Automate with **JAWS** for full dump.

